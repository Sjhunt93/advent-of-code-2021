Had to discard this and use python to solve (was a pig)